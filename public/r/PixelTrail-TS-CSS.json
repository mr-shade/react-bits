{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "PixelTrail-TS-CSS",
  "type": "registry:block",
  "title": "PixelTrail",
  "description": "Pixelated cursor trail emitting fading squares with retro digital feel.",
  "dependencies": [
    "@react-three/drei",
    "@react-three/fiber",
    "three"
  ],
  "files": [
    {
      "path": "public/ts/default/src/ts-default/Animations/PixelTrail/PixelTrail.tsx",
      "content": "/* eslint-disable react/no-unknown-property */\r\nimport React, { useMemo } from 'react';\r\nimport { Canvas, useThree, CanvasProps, ThreeEvent } from '@react-three/fiber';\r\nimport { shaderMaterial, useTrailTexture } from '@react-three/drei';\r\nimport * as THREE from 'three';\r\n\r\nimport './PixelTrail.css';\r\n\r\ninterface GooeyFilterProps {\r\n  id?: string;\r\n  strength?: number;\r\n}\r\n\r\ninterface DotMaterialUniforms {\r\n  resolution: THREE.Vector2;\r\n  mouseTrail: THREE.Texture | null;\r\n  gridSize: number;\r\n  pixelColor: THREE.Color;\r\n}\r\n\r\ninterface SceneProps {\r\n  gridSize: number;\r\n  trailSize: number;\r\n  maxAge: number;\r\n  interpolate: number;\r\n  easingFunction: (x: number) => number;\r\n  pixelColor: string;\r\n}\r\n\r\ninterface PixelTrailProps {\r\n  gridSize?: number;\r\n  trailSize?: number;\r\n  maxAge?: number;\r\n  interpolate?: number;\r\n  easingFunction?: (x: number) => number;\r\n  canvasProps?: Partial<CanvasProps>;\r\n  glProps?: WebGLContextAttributes & { powerPreference?: string };\r\n  gooeyFilter?: { id: string; strength: number };\r\n  color?: string;\r\n  className?: string;\r\n}\r\n\r\nconst GooeyFilter: React.FC<GooeyFilterProps> = ({ id = 'goo-filter', strength = 10 }) => {\r\n  return (\r\n    <svg className=\"goo-filter-container\">\r\n      <defs>\r\n        <filter id={id}>\r\n          <feGaussianBlur in=\"SourceGraphic\" stdDeviation={strength} result=\"blur\" />\r\n          <feColorMatrix in=\"blur\" type=\"matrix\" values=\"1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 19 -9\" result=\"goo\" />\r\n          <feComposite in=\"SourceGraphic\" in2=\"goo\" operator=\"atop\" />\r\n        </filter>\r\n      </defs>\r\n    </svg>\r\n  );\r\n};\r\n\r\nconst DotMaterial = shaderMaterial(\r\n  {\r\n    resolution: new THREE.Vector2(),\r\n    mouseTrail: null,\r\n    gridSize: 100,\r\n    pixelColor: new THREE.Color('#ffffff')\r\n  },\r\n  /* glsl vertex shader */ `\r\n    varying vec2 vUv;\r\n    void main() {\r\n      gl_Position = vec4(position.xy, 0.0, 1.0);\r\n    }\r\n  `,\r\n  /* glsl fragment shader */ `\r\n    uniform vec2 resolution;\r\n    uniform sampler2D mouseTrail;\r\n    uniform float gridSize;\r\n    uniform vec3 pixelColor;\r\n\r\n    vec2 coverUv(vec2 uv) {\r\n      vec2 s = resolution.xy / max(resolution.x, resolution.y);\r\n      vec2 newUv = (uv - 0.5) * s + 0.5;\r\n      return clamp(newUv, 0.0, 1.0);\r\n    }\r\n\r\n    float sdfCircle(vec2 p, float r) {\r\n        return length(p - 0.5) - r;\r\n    }\r\n\r\n    void main() {\r\n      vec2 screenUv = gl_FragCoord.xy / resolution;\r\n      vec2 uv = coverUv(screenUv);\r\n\r\n      vec2 gridUv = fract(uv * gridSize);\r\n      vec2 gridUvCenter = (floor(uv * gridSize) + 0.5) / gridSize;\r\n\r\n      float trail = texture2D(mouseTrail, gridUvCenter).r;\r\n\r\n      gl_FragColor = vec4(pixelColor, trail);\r\n    }\r\n  `\r\n);\r\n\r\nfunction Scene({ gridSize, trailSize, maxAge, interpolate, easingFunction, pixelColor }: SceneProps) {\r\n  const size = useThree(s => s.size);\r\n  const viewport = useThree(s => s.viewport);\r\n\r\n  const dotMaterial = useMemo(() => new DotMaterial(), []);\r\n  dotMaterial.uniforms.pixelColor.value = new THREE.Color(pixelColor);\r\n\r\n  const [trail, onMove] = useTrailTexture({\r\n    size: 512,\r\n    radius: trailSize,\r\n    maxAge: maxAge,\r\n    interpolate: interpolate || 0.1,\r\n    ease: easingFunction || ((x: number) => x)\r\n  }) as [THREE.Texture | null, (e: ThreeEvent<PointerEvent>) => void];\r\n\r\n  if (trail) {\r\n    trail.minFilter = THREE.NearestFilter;\r\n    trail.magFilter = THREE.NearestFilter;\r\n    trail.wrapS = THREE.ClampToEdgeWrapping;\r\n    trail.wrapT = THREE.ClampToEdgeWrapping;\r\n  }\r\n\r\n  const scale = Math.max(viewport.width, viewport.height) / 2;\r\n\r\n  return (\r\n    <mesh scale={[scale, scale, 1]} onPointerMove={onMove}>\r\n      <planeGeometry args={[2, 2]} />\r\n      <primitive\r\n        object={dotMaterial}\r\n        gridSize={gridSize}\r\n        resolution={[size.width * viewport.dpr, size.height * viewport.dpr]}\r\n        mouseTrail={trail}\r\n      />\r\n    </mesh>\r\n  );\r\n}\r\n\r\nexport default function PixelTrail({\r\n  gridSize = 40,\r\n  trailSize = 0.1,\r\n  maxAge = 250,\r\n  interpolate = 5,\r\n  easingFunction = (x: number) => x,\r\n  canvasProps = {},\r\n  glProps = {\r\n    antialias: false,\r\n    powerPreference: 'high-performance',\r\n    alpha: true\r\n  },\r\n  gooeyFilter,\r\n  color = '#ffffff',\r\n  className = ''\r\n}: PixelTrailProps) {\r\n  return (\r\n    <>\r\n      {gooeyFilter && <GooeyFilter id={gooeyFilter.id} strength={gooeyFilter.strength} />}\r\n      <Canvas\r\n        {...canvasProps}\r\n        gl={glProps}\r\n        className={`pixel-canvas ${className}`}\r\n        style={gooeyFilter ? { filter: `url(#${gooeyFilter.id})` } : undefined}\r\n      >\r\n        <Scene\r\n          gridSize={gridSize}\r\n          trailSize={trailSize}\r\n          maxAge={maxAge}\r\n          interpolate={interpolate}\r\n          easingFunction={easingFunction}\r\n          pixelColor={color}\r\n        />\r\n      </Canvas>\r\n    </>\r\n  );\r\n}\r\n",
      "type": "registry:component"
    },
    {
      "path": "public/ts/default/src/ts-default/Animations/PixelTrail/PixelTrail.css",
      "content": ".goo-filter-container {\r\n  position: absolute;\r\n  overflow: hidden;\r\n  z-index: 1;\r\n}\r\n\r\n.pixel-canvas {\r\n  position: absolute;\r\n  z-index: 1;\r\n}\r\n",
      "type": "registry:item"
    }
  ]
}