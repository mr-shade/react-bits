{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "StickerPeel-TS-TW",
  "type": "registry:block",
  "title": "StickerPeel",
  "description": "Sticker corner lift + peel interaction using 3D transform and shadow depth.",
  "dependencies": [
    "gsap"
  ],
  "files": [
    {
      "path": "public/ts/tailwind/src/ts-tailwind/Animations/StickerPeel/StickerPeel.tsx",
      "content": "import { useRef, useEffect, useMemo, CSSProperties } from 'react';\r\nimport { gsap } from 'gsap';\r\nimport { Draggable } from 'gsap/Draggable';\r\n\r\ngsap.registerPlugin(Draggable);\r\n\r\ninterface StickerPeelProps {\r\n  imageSrc: string;\r\n  rotate?: number;\r\n  peelBackHoverPct?: number;\r\n  peelBackActivePct?: number;\r\n  peelEasing?: string;\r\n  peelHoverEasing?: string;\r\n  width?: number;\r\n  shadowIntensity?: number;\r\n  lightingIntensity?: number;\r\n  initialPosition?: 'center' | 'random' | { x: number; y: number };\r\n  peelDirection?: number;\r\n  className?: string;\r\n}\r\n\r\ninterface CSSVars extends CSSProperties {\r\n  '--sticker-rotate'?: string;\r\n  '--sticker-p'?: string;\r\n  '--sticker-peelback-hover'?: string;\r\n  '--sticker-peelback-active'?: string;\r\n  '--sticker-peel-easing'?: string;\r\n  '--sticker-peel-hover-easing'?: string;\r\n  '--sticker-width'?: string;\r\n  '--sticker-shadow-opacity'?: number;\r\n  '--sticker-lighting-constant'?: number;\r\n  '--peel-direction'?: string;\r\n  '--sticker-start'?: string;\r\n  '--sticker-end'?: string;\r\n}\r\n\r\nconst StickerPeel: React.FC<StickerPeelProps> = ({\r\n  imageSrc,\r\n  rotate = 30,\r\n  peelBackHoverPct = 30,\r\n  peelBackActivePct = 40,\r\n  peelEasing = 'power3.out',\r\n  peelHoverEasing = 'power2.out',\r\n  width = 200,\r\n  shadowIntensity = 0.6,\r\n  lightingIntensity = 0.1,\r\n  initialPosition = 'center',\r\n  peelDirection = 0,\r\n  className = ''\r\n}) => {\r\n  const containerRef = useRef<HTMLDivElement>(null);\r\n  const dragTargetRef = useRef<HTMLDivElement>(null);\r\n  const pointLightRef = useRef<SVGFEPointLightElement>(null);\r\n  const pointLightFlippedRef = useRef<SVGFEPointLightElement>(null);\r\n  const draggableInstanceRef = useRef<Draggable | null>(null);\r\n\r\n  const defaultPadding = 12;\r\n\r\n  useEffect(() => {\r\n    const target = dragTargetRef.current;\r\n    if (!target) return;\r\n\r\n    let startX = 0,\r\n      startY = 0;\r\n\r\n    if (initialPosition === 'center') {\r\n      return;\r\n    }\r\n\r\n    if (typeof initialPosition === 'object' && initialPosition.x !== undefined && initialPosition.y !== undefined) {\r\n      startX = initialPosition.x;\r\n      startY = initialPosition.y;\r\n    }\r\n\r\n    gsap.set(target, { x: startX, y: startY });\r\n  }, [initialPosition]);\r\n\r\n  useEffect(() => {\r\n    const target = dragTargetRef.current;\r\n    if (!target) return;\r\n\r\n    const boundsEl = target.parentNode as HTMLElement;\r\n\r\n    const draggable = Draggable.create(target, {\r\n      type: 'x,y',\r\n      bounds: boundsEl,\r\n      inertia: true,\r\n      onDrag(this: Draggable) {\r\n        const rot = gsap.utils.clamp(-24, 24, this.deltaX * 0.4);\r\n        gsap.to(target, { rotation: rot, duration: 0.15, ease: 'power1.out' });\r\n      },\r\n      onDragEnd() {\r\n        const rotationEase = 'power2.out';\r\n        const duration = 0.8;\r\n        gsap.to(target, { rotation: 0, duration, ease: rotationEase });\r\n      }\r\n    });\r\n\r\n    draggableInstanceRef.current = draggable[0];\r\n\r\n    const handleResize = () => {\r\n      if (draggableInstanceRef.current) {\r\n        draggableInstanceRef.current.update();\r\n\r\n        const currentX = gsap.getProperty(target, 'x') as number;\r\n        const currentY = gsap.getProperty(target, 'y') as number;\r\n\r\n        const boundsRect = boundsEl.getBoundingClientRect();\r\n        const targetRect = target.getBoundingClientRect();\r\n\r\n        const maxX = boundsRect.width - targetRect.width;\r\n        const maxY = boundsRect.height - targetRect.height;\r\n\r\n        const newX = Math.max(0, Math.min(currentX, maxX));\r\n        const newY = Math.max(0, Math.min(currentY, maxY));\r\n\r\n        if (newX !== currentX || newY !== currentY) {\r\n          gsap.to(target, {\r\n            x: newX,\r\n            y: newY,\r\n            duration: 0.3,\r\n            ease: 'power2.out'\r\n          });\r\n        }\r\n      }\r\n    };\r\n\r\n    window.addEventListener('resize', handleResize);\r\n    window.addEventListener('orientationchange', handleResize);\r\n\r\n    return () => {\r\n      window.removeEventListener('resize', handleResize);\r\n      window.removeEventListener('orientationchange', handleResize);\r\n      if (draggableInstanceRef.current) {\r\n        draggableInstanceRef.current.kill();\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const updateLight = (e: Event) => {\r\n      const mouseEvent = e as MouseEvent;\r\n      const rect = containerRef.current?.getBoundingClientRect();\r\n      if (!rect) return;\r\n\r\n      const x = mouseEvent.clientX - rect.left;\r\n      const y = mouseEvent.clientY - rect.top;\r\n\r\n      if (pointLightRef.current) {\r\n        gsap.set(pointLightRef.current, { attr: { x, y } });\r\n      }\r\n\r\n      const normalizedAngle = Math.abs(peelDirection % 360);\r\n      if (pointLightFlippedRef.current) {\r\n        if (normalizedAngle !== 180) {\r\n          gsap.set(pointLightFlippedRef.current, {\r\n            attr: { x, y: rect.height - y }\r\n          });\r\n        } else {\r\n          gsap.set(pointLightFlippedRef.current, {\r\n            attr: { x: -1000, y: -1000 }\r\n          });\r\n        }\r\n      }\r\n    };\r\n\r\n    const container = containerRef.current;\r\n    const eventType = 'mousemove';\r\n\r\n    if (container) {\r\n      container.addEventListener(eventType, updateLight);\r\n      return () => container.removeEventListener(eventType, updateLight);\r\n    }\r\n  }, [peelDirection]);\r\n\r\n  useEffect(() => {\r\n    const container = containerRef.current;\r\n    if (!container) return;\r\n\r\n    const handleTouchStart = () => {\r\n      container.classList.add('touch-active');\r\n    };\r\n\r\n    const handleTouchEnd = () => {\r\n      container.classList.remove('touch-active');\r\n    };\r\n\r\n    container.addEventListener('touchstart', handleTouchStart);\r\n    container.addEventListener('touchend', handleTouchEnd);\r\n    container.addEventListener('touchcancel', handleTouchEnd);\r\n\r\n    return () => {\r\n      container.removeEventListener('touchstart', handleTouchStart);\r\n      container.removeEventListener('touchend', handleTouchEnd);\r\n      container.removeEventListener('touchcancel', handleTouchEnd);\r\n    };\r\n  }, []);\r\n\r\n  const cssVars: CSSVars = useMemo(\r\n    () => ({\r\n      '--sticker-rotate': `${rotate}deg`,\r\n      '--sticker-p': `${defaultPadding}px`,\r\n      '--sticker-peelback-hover': `${peelBackHoverPct}%`,\r\n      '--sticker-peelback-active': `${peelBackActivePct}%`,\r\n      '--sticker-peel-easing': peelEasing,\r\n      '--sticker-peel-hover-easing': peelHoverEasing,\r\n      '--sticker-width': `${width}px`,\r\n      '--sticker-shadow-opacity': shadowIntensity,\r\n      '--sticker-lighting-constant': lightingIntensity,\r\n      '--peel-direction': `${peelDirection}deg`,\r\n      '--sticker-start': `calc(-1 * ${defaultPadding}px)`,\r\n      '--sticker-end': `calc(100% + ${defaultPadding}px)`\r\n    }),\r\n    [\r\n      rotate,\r\n      peelBackHoverPct,\r\n      peelBackActivePct,\r\n      peelEasing,\r\n      peelHoverEasing,\r\n      width,\r\n      shadowIntensity,\r\n      lightingIntensity,\r\n      peelDirection,\r\n      defaultPadding\r\n    ]\r\n  );\r\n\r\n  const stickerMainStyle: CSSProperties = {\r\n    clipPath: `polygon(var(--sticker-start) var(--sticker-start), var(--sticker-end) var(--sticker-start), var(--sticker-end) var(--sticker-end), var(--sticker-start) var(--sticker-end))`,\r\n    transition: 'clip-path 0.6s ease-out',\r\n    filter: 'url(#dropShadow)',\r\n    willChange: 'clip-path, transform'\r\n  };\r\n\r\n  const flapStyle: CSSProperties = {\r\n    clipPath: `polygon(var(--sticker-start) var(--sticker-start), var(--sticker-end) var(--sticker-start), var(--sticker-end) var(--sticker-start), var(--sticker-start) var(--sticker-start))`,\r\n    top: `calc(-100% - var(--sticker-p) - var(--sticker-p))`,\r\n    transform: 'scaleY(-1)',\r\n    transition: 'all 0.6s ease-out',\r\n    willChange: 'clip-path, transform'\r\n  };\r\n\r\n  const imageStyle: CSSProperties = {\r\n    transform: `rotate(calc(${rotate}deg - ${peelDirection}deg))`,\r\n    width: `${width}px`\r\n  };\r\n\r\n  const shadowImageStyle: CSSProperties = {\r\n    ...imageStyle,\r\n    filter: 'url(#expandAndFill)'\r\n  };\r\n\r\n  return (\r\n    <div\r\n      className={`absolute cursor-grab active:cursor-grabbing transform-gpu ${className}`}\r\n      ref={dragTargetRef}\r\n      style={cssVars}\r\n    >\r\n      <style\r\n        dangerouslySetInnerHTML={{\r\n          __html: `\r\n          .sticker-container:hover .sticker-main,\r\n          .sticker-container.touch-active .sticker-main {\r\n            clip-path: polygon(var(--sticker-start) var(--sticker-peelback-hover), var(--sticker-end) var(--sticker-peelback-hover), var(--sticker-end) var(--sticker-end), var(--sticker-start) var(--sticker-end)) !important;\r\n          }\r\n          .sticker-container:hover .sticker-flap,\r\n          .sticker-container.touch-active .sticker-flap {\r\n            clip-path: polygon(var(--sticker-start) var(--sticker-start), var(--sticker-end) var(--sticker-start), var(--sticker-end) var(--sticker-peelback-hover), var(--sticker-start) var(--sticker-peelback-hover)) !important;\r\n            top: calc(-100% + 2 * var(--sticker-peelback-hover) - 1px) !important;\r\n          }\r\n          .sticker-container:active .sticker-main {\r\n            clip-path: polygon(var(--sticker-start) var(--sticker-peelback-active), var(--sticker-end) var(--sticker-peelback-active), var(--sticker-end) var(--sticker-end), var(--sticker-start) var(--sticker-end)) !important;\r\n          }\r\n          .sticker-container:active .sticker-flap {\r\n            clip-path: polygon(var(--sticker-start) var(--sticker-start), var(--sticker-end) var(--sticker-start), var(--sticker-end) var(--sticker-peelback-active), var(--sticker-start) var(--sticker-peelback-active)) !important;\r\n            top: calc(-100% + 2 * var(--sticker-peelback-active) - 1px) !important;\r\n          }\r\n        `\r\n        }}\r\n      />\r\n\r\n      <svg width=\"0\" height=\"0\">\r\n        <defs>\r\n          <filter id=\"pointLight\">\r\n            <feGaussianBlur stdDeviation=\"1\" result=\"blur\" />\r\n            <feSpecularLighting\r\n              result=\"spec\"\r\n              in=\"blur\"\r\n              specularExponent=\"100\"\r\n              specularConstant={lightingIntensity}\r\n              lightingColor=\"white\"\r\n            >\r\n              <fePointLight ref={pointLightRef} x=\"100\" y=\"100\" z=\"300\" />\r\n            </feSpecularLighting>\r\n            <feComposite in=\"spec\" in2=\"SourceGraphic\" result=\"lit\" />\r\n            <feComposite in=\"lit\" in2=\"SourceAlpha\" operator=\"in\" />\r\n          </filter>\r\n\r\n          <filter id=\"pointLightFlipped\">\r\n            <feGaussianBlur stdDeviation=\"10\" result=\"blur\" />\r\n            <feSpecularLighting\r\n              result=\"spec\"\r\n              in=\"blur\"\r\n              specularExponent=\"100\"\r\n              specularConstant={lightingIntensity * 7}\r\n              lightingColor=\"white\"\r\n            >\r\n              <fePointLight ref={pointLightFlippedRef} x=\"100\" y=\"100\" z=\"300\" />\r\n            </feSpecularLighting>\r\n            <feComposite in=\"spec\" in2=\"SourceGraphic\" result=\"lit\" />\r\n            <feComposite in=\"lit\" in2=\"SourceAlpha\" operator=\"in\" />\r\n          </filter>\r\n\r\n          <filter id=\"dropShadow\">\r\n            <feDropShadow\r\n              dx=\"2\"\r\n              dy=\"4\"\r\n              stdDeviation={3 * shadowIntensity}\r\n              floodColor=\"black\"\r\n              floodOpacity={shadowIntensity}\r\n            />\r\n          </filter>\r\n\r\n          <filter id=\"expandAndFill\">\r\n            <feOffset dx=\"0\" dy=\"0\" in=\"SourceAlpha\" result=\"shape\" />\r\n            <feFlood floodColor=\"rgb(179,179,179)\" result=\"flood\" />\r\n            <feComposite operator=\"in\" in=\"flood\" in2=\"shape\" />\r\n          </filter>\r\n        </defs>\r\n      </svg>\r\n\r\n      <div\r\n        className=\"sticker-container relative select-none touch-none sm:touch-auto\"\r\n        ref={containerRef}\r\n        style={{\r\n          WebkitUserSelect: 'none',\r\n          userSelect: 'none',\r\n          WebkitTouchCallout: 'none',\r\n          WebkitTapHighlightColor: 'transparent',\r\n          transform: `rotate(${peelDirection}deg)`,\r\n          transformOrigin: 'center'\r\n        }}\r\n      >\r\n        <div className=\"sticker-main\" style={stickerMainStyle}>\r\n          <div style={{ filter: 'url(#pointLight)' }}>\r\n            <img\r\n              src={imageSrc}\r\n              alt=\"\"\r\n              className=\"block\"\r\n              style={imageStyle}\r\n              draggable=\"false\"\r\n              onContextMenu={e => e.preventDefault()}\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"absolute top-4 left-2 w-full h-full opacity-40\" style={{ filter: 'brightness(0) blur(8px)' }}>\r\n          <div className=\"sticker-flap\" style={flapStyle}>\r\n            <img\r\n              src={imageSrc}\r\n              alt=\"\"\r\n              className=\"block\"\r\n              style={shadowImageStyle}\r\n              draggable=\"false\"\r\n              onContextMenu={e => e.preventDefault()}\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"sticker-flap absolute w-full h-full left-0\" style={flapStyle}>\r\n          <div style={{ filter: 'url(#pointLightFlipped)' }}>\r\n            <img\r\n              src={imageSrc}\r\n              alt=\"\"\r\n              className=\"block\"\r\n              style={shadowImageStyle}\r\n              draggable=\"false\"\r\n              onContextMenu={e => e.preventDefault()}\r\n            />\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default StickerPeel;\r\n",
      "type": "registry:component"
    }
  ]
}